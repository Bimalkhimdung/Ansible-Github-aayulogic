  name: ssh to remote user

  on:
   push:
     branches:
       - main

  jobs:
    ssh-to-remote:
      runs-on: ubuntu-latest

      steps:
       - name: checkout code
         uses: actions/checkout@v2
  #   - name: adding known hosts
  #      run: ssh-keyscan -H ${{ secrets.SERVER_IP}}{%en-draw%} >> ~/.ssh/known_hosts
       - name: ssh to remote
         uses: shimataro/ssh-key-action@v2
         with:
           key: ${{ secrets.SERVER_PRIVATE_KEY }}
    # known_hosts: ${{ secrets.SERVER_IP }}
       - name: adding hosts
         run: ssh-keyscan -H ${{ secrets.SERVER_IP}}{%en-draw%} >> ~/.ssh/known_hosts

           
       - name: copy with rsync
         run: rsync -avz -e "ssh -p${{secrets.SERVER_PORT}}" ./app.py ${{secrets.SERVER_USRNAME}}@${{ secrets.SERVER_IP}}:/home/devops/

